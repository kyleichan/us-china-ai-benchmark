<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<style>* { margin: 0; padding: 0; } body { background: #0a0a14; overflow: hidden; } canvas { display: block; }</style>
</head>
<body>
<canvas id="c" width="250" height="400"></canvas>
<script>
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
const balls = [];
let hexagons = [];

function createHexagon(radius, lineWidth, color) {
    const sides = 6;
    const points = [];
    const rotation = Math.PI / 6;
    for (let i = 0; i < sides; i++) {
        if (i === 2) continue;
        const angle = i * (2 * Math.PI / sides) + rotation;
        points.push({
            x: 125 + radius * Math.cos(angle),
            y: 200 + radius * Math.sin(angle)
        });
    }
    return {points, lineWidth, color};
}

function initHexagons() {
    hexagons = [
        createHexagon(30, 2, '#ff6b6b'),
        createHexagon(60, 3, '#4ecdc4'),
        createHexagon(90, 4, '#45b7d1')
    ];
}

function drawHexagon(hex, rotation) {
    ctx.beginPath();
    const sides = hex.points.length;
    for (let i = 0; i < sides; i++) {
        const p = hex.points[i];
        const x = 125 + (p.x - 125) * Math.cos(rotation) - (p.y - 200) * Math.sin(rotation);
        const y = 200 + (p.x - 125) * Math.sin(rotation) + (p.y - 200) * Math.cos(rotation);
        if (i === 0) ctx.moveTo(x, y);
        else ctx.lineTo(x, y);
    }
    ctx.closePath();
    ctx.lineWidth = hex.lineWidth;
    ctx.strokeStyle = hex.color;
    ctx.stroke();
}

class Ball {
    constructor() {
        this.reset();
        this.radius = 4;
        this.color = `hsl(${Math.random() * 360}, 100%, 60%)`;
    }
    reset() {
        this.x = 125;
        this.y = 200;
        this.vx = (Math.random() - 0.5) * 6;
        this.vy = (Math.random() - 0.5) * 6;
        this.active = true;
    }
    update() {
        if (!this.active) return;
        this.x += this.vx;
        this.y += this.vy;
        this.vy += 0.08;
        this.vx *= 0.995;
        this.vy *= 0.995;
        const dist = Math.hypot(this.x - 125, this.y - 200);
        if (dist > 120) {
            this.active = false;
            return;
        }
        hexagons.forEach(hex => {
            const sides = hex.points.length;
            for (let i = 0; i < sides; i++) {
                const p1 = hex.points[i];
                const p2 = hex.points[(i + 1) % sides];
                const dx = p2.x - p1.x;
                const dy = p2.y - p1.y;
                const length = Math.hypot(dx, dy);
                const nx = -dy / length;
                const ny = dx / length;
                const relX = this.x - p1.x;
                const relY = this.y - p1.y;
                const dot = relX * nx + relY * ny;
                if (Math.abs(dot) < this.radius + hex.lineWidth / 2) {
                    const edgeDist = Math.abs((relX * dy - relY * dx) / length);
                    if (edgeDist < length) {
                        const proj = relX * dx / length + relY * dy / length;
                        if (proj > 0 && proj < length) {
                            this.x -= nx * (this.radius + hex.lineWidth / 2 - dot);
                            this.y -= ny * (this.radius + hex.lineWidth / 2 - dot);
                            const d = this.vx * nx + this.vy * ny;
                            this.vx -= 2 * d * nx * 0.8;
                            this.vy -= 2 * d * ny * 0.8;
                        }
                    }
                }
            }
        });
    }
    draw() {
        if (!this.active) return;
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
        ctx.fillStyle = this.color;
        ctx.fill();
    }
}

initHexagons();
let rotation = 0;
let lastTime = 0;
let ballCounter = 0;

function animate(timestamp) {
    const delta = Math.min(timestamp - lastTime, 50) / 16;
    lastTime = timestamp;
    ctx.clearRect(0, 0, 250, 400);
    rotation += 0.005 * delta;
    hexagons.forEach((hex, i) => {
        drawHexagon(hex, rotation * (i % 2 ? 1 : -1) * (i + 1));
    });
    ballCounter += delta;
    if (ballCounter > 10 && balls.length < 25) {
        balls.push(new Ball());
        ballCounter = 0;
    }
    balls.forEach(ball => ball.update());
    balls.forEach(ball => ball.draw());
    for (let i = balls.length - 1; i >= 0; i--) {
        if (!balls[i].active) balls.splice(i, 1);
    }
    requestAnimationFrame(animate);
}
requestAnimationFrame(animate);
</script>
</body>
</html>